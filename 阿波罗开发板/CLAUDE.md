# Claude工作指南

## 工作模式
1. **分析模式**：用户要求"分析"时，提供技术分析和可能的方案
2. **执行模式**：收到"任务卡"时，直接执行，不讨论
3. **讨论模式**：其他情况可正常技术讨论

### 重要原则
- **理解意图优先**：完整阅读用户指令，理解真实需求
- **按指令执行**：用户明确要求时才使用特定技术（如条件编译）
- **不过度解读**：避免自作主张添加用户未要求的功能

## 基本要求
- **使用中文**交流和注释
- **任务卡直接执行**，不提供替代方案
- **不要自动编译或运行**程序
- 分析时可以提供多种方案供选择

## 项目关键约束
- STM32H743 LTDC显示驱动，480x272 RGB565
- CFBLR寄存器固定值：`0x03C003C0`（960字节stride）
- DMA2D计算使用像素口径：`STRIDE_PIXELS=480`
- 唯一重载点：`configure_layer_with_stride()`
- 帧缓冲地址：`0x24000080`（D1 SRAM）

## SDRAM模块约束
- W9825G6KH配置：Bank1@0xC0000000
- 使用BSP模块方式，不修改.ioc文件
- 健康检查从寄存器实时读取，禁止硬编码常量
- SDRAM_DEBUG宏控制详细日志（默认0）

## 编译和链接注意事项
- **符号定义**：全局变量只能定义一次，其他地方用extern
- **编译警告**：保持0 warning，合理处理未使用的函数
- **条件编译**：仅在用户明确要求时使用（如SDRAM_DEBUG）

## 禁止事项
- ❌ 不要使用HAL_RCCEx_GetPeriphCLKFreq（返回0）
- ❌ 不要创建CPU填充兜底方案
- ❌ 不要修改CFBLR值
- ❌ 不要添加第二个重载点
- ❌ 不要硬编码应该实时读取的值
- ❌ 不要自作主张删除或修改代码（除非用户明确要求）

## 任务卡识别
标题包含"任务卡"、"任务名"等关键词时，进入执行模式。

## 任务执行要点
1. **完整理解**：先完整阅读任务要求，理解用户意图
2. **精确执行**：严格按照用户指令，不过度解读
3. **确认理解**：对复杂要求，可先确认理解是否正确
4. **最小改动**：只改动用户要求的部分，避免额外修改